<!DOCTYPE html>
<html lang="zh-cmn-Hans">
<head>
    <meta http-equiv="X-UA-Compatible" content="IE=Edge"/>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
    <meta name="viewport"
          content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no, shrink-to-fit=no">
    <title>腾讯IM(直播聊天室) Web Demo(V1.2)</title>
    <meta name="keywords" content="">
    <meta name="description" content="">
    <meta name="format-detection" content="telephone=no">   
    <link rel="stylesheet" type="text/css" href="lib/css/jquery-weui.css"/>
    <link rel="stylesheet" type="text/css" href="lib/css/weui.css"/>
    <link rel="stylesheet" type="text/css" href="css/animate.css"/>
    <link rel="stylesheet" href="./css/mobile.css?v=1.0.3?time = New Data()">
    <link rel="stylesheet" type="text/css" href="css/base.css"/>
    <link rel="stylesheet" type="text/css" href="css/index.css?time = New Data()"/>
 
    <script>
    	var oHtml = document.getElementsByTagName("html")[0];
		var screenW = document.documentElement.offsetWidth || document.body.offsetWidth;
		oHtml.style.fontSize = 100 * screenW / 375 + "px";
    </script>
    <style>
    	.pause{
    		border-radius: 50%;
    		width: 1rem;
    		height: 1rem;
		    position: absolute;
		    left: 50%;
		    top: 50%;
		    transform: translate(-50%,-50%);
		    -webkit-transform: translate(-50%,-50%);
		    z-index: 3;
    		background: url(img/pause.png);
    		background-size: 1rem auto;
    		background-repeat: no-repeat;
    	}
    	.hide{
    		display: none;
    	}
    	.vcp-poster-pic.cover, .vcp-poster-pic.default{
    		width: 100%;
    		height: 100%;
    	}
    	.video-play{
    		margin: 0 auto;
    		transition:all 0.3s;
    	}
    	.reply{
    		max-width: 2rem;
    		word-break: break-all;
    		display: -webkit-box; 
    		-webkit-box-orient: vertical; 
    		text-overflow: ellipsis;
    		-webkit-line-clamp: 5;
    		overflow: hidden;
    		background: #FFFFFF;
			-webkit-box-shadow:0 0 10px rgba(0, 0, 0, .2); 
    		border-radius: 0.1rem;
    		padding: 0.08rem;
    		font-size: 0.14rem;
    		line-height: 0.18rem;
    		z-index: 999;
    		margin-top: 0.1rem;
    	}
    	.reply-box{
    		max-width: 2rem;
    		height: auto;
    		display: none;
    		position: absolute;
    		top: 51px;
    		z-index: 999;
    	}
    	.reply-box:before{
		    content: '';
		    width: 0;
		    height: 0;
		    border-left: .12rem solid transparent;
		    border-right: .12rem solid transparent;
		    border-bottom: .12rem solid #fff;
		    -webkit-transform: rotate(0deg);
		    -moz-transform: rotate(0deg);
		    -ms-transform: rotate(0deg);
		    -o-transform: rotate(0deg);
		    transform: rotate(0deg);
		    position: absolute;
		    left: 0.1rem;
    	}
    	.reply i{
    		color: #4583FF;
    	}
    </style>
</head>
<body class="no-cache">
<div class="video-page">
    <!--视频部分 start-->
    <div class="video-play" style="height: 100%;" id="id_test_video">
        <!--<video id="myVideo" src="http://wssource.hls.inke.cn/live/1526086834771652/playlist.m3u8" preload="auto" poster="https://img2.inke.cn/MTUyNTU2NzAyMzAwNyMyOTUjanBn.jpg" webkit-playsinline="true" playsinline="true" x-webkit-airplay="true" x5-video-player-type="h5" x5-video-player-fullscreen="true" x5-video-ignore-metadata="true" style="width: 100%; object-fit: cover;"></video> -->      	
        <!--下列图片可删除，在此做视频示意-->
        <!--<img src="./img/back-img2.png" width="100%" height="100%">-->
    </div>
    <!--视频部分 end-->

    <!--聊天部分 start-->
    <div class="video-pane">
    	<div class="big-log-box">
    		<!--<div class="big-logo">
				<div class="big-log-1">
					<img src="img/kuanye.png" />
					<p>******鱼已拿货超过5件,达到撒旦撒旦撒</p>
				</div>
			</div>-->
    	</div>
        <div class="video-pane-head">
            <div class="video-pane-info">
            	<div class="reply-box">
                	<div class="reply"><i>主播回复@蚊子:</i>达萨达萨达达萨达萨达撒达萨达萨达达萨达达萨达萨达撒达萨达萨达萨达达萨达萨达撒达萨达萨达萨达撒</div>
                </div>
                <div class="video-info">
                    <div class="user-img">
                        <img src="./img/user-img.png" width="45">
                    </div>
                    <div class="user-info-text">
                        <div class="user-info-name">美女主播朴信惠</div>
                        <div class="user-info-num">
                        	<i>2000</i>人观看
                            <!--<i class="user-icon-fans"></i><span id="user-icon-fans">0</span>
                            <i class="user-icon-like"></i><span id="user-icon-like">0</span>-->
                        </div>
                    </div>                   
                </div>
                <div class="follow">
                	<img src="img/btn_follow@2x.png" />
                </div>
                <div class="cloudId">ID:455444</div>
            </div>
            <div class="g-take">
            	<div class="ic-car-num">
            		<i style="color: #FF5959;">57</i>人拿了货
            	</div>
            </div>
            <div class="hot">
            	<img src="img/hot.png" class="hot-bg"/>
            	<i class="hot-num">56</i>
            	<div class="hot-pic">
            		<img src="img/2017.jpg" />
            	</div>
            	<i class="hot-name">已售 200</i>
            </div>
           <!-- <a href="javascript:void(0);" class="video-close" onclick="quitBigGroup()"></a>-->
        </div>
        <div class="video-pane-body">
        	<div class="tip-box">
        		<!--<div class="follow-tip animated fadeInLeft">
	        		<div class="tip-icon">
	        			<img src="img/follow-logo.png" />
	        		</div>
	        		<span>美少女星星</span>
	        		关注了主播
	        	</div>-->
        	</div>
            <div class="video-discuss">
                <ul class="video-sms-list" id="video_sms_list">
                    <!--
                    <li>
                        <div class="video-sms-pane">
                            <div class="video-sms-text"><span class="user-name-green" >毛利晴</span>有品位</div>
                        </div>
                    </li>
                    <li>
                        <div class="video-sms-pane">
                            <div class="video-sms-text"><span class="user-name-red">近朱者赤进入房间</span></div>
                        </div>
                    </li>
                    <li>
                        <div class="video-sms-pane">
                            <div class="video-sms-text"><span class="user-name-blue">janzhu</span>美女你好</div>
                        </div>
                    </li>
                    <li>
                        <div class="video-sms-pane">
                            <div class="video-sms-text"><span class="user-name-org">cherylma</span>美女你好美女你好美女你好重要的事情说3遍</div>
                        </div>
                    </li>
                    -->

                </ul>
                <div class="video-discuss-pane">
                	<div class="now-goods">
                		<div class="scroll-now-goods">
                			<div class="now-g-item">
	                			<div class="ic-num-bg">
	                				32
	                			</div>
	                			<div class="now-g-price ellip">￥58.00起</div>
	                		</div>
	                		<div class="now-g-item">
	                			<div class="ic-num-bg">
	                				32
	                			</div>
	                			<div class="now-g-price ellip">￥59.00起</div>
	                		</div>
                		</div>
                	</div>
                	<div class="bag">
                		1234
                	</div>
                    <div class="video-discuss-tool" id="video-discuss-tool">
                    	<p class="ic-like" onclick="sendGroupLoveMsg()"></p>
                    	<p class="ic-chat" onclick="smsPicClick()"></p>
                    	<div class="love-count" id="user-icon-like">1</div>
                        <!--<span class="like-icon zoomIn green"></span>-->
                        <!--<a href="javascript:void(0);" class="video-discuss-sms" onclick="smsPicClick()"></a>

                        <a href="javascript:void(0);" class="video-discuss-like" onclick="sendGroupLoveMsg()"></a>-->
                    </div>                                      
                </div>
                <div class="video-discuss-form" id="video-discuss-form" style="display: none">
                    <a href="javascript:;" class="video-discuss-face" onclick="onSendMsg()">发送</a>
                    <input placeholder="跟主播聊点什么" maxlength="50" class="video-discuss-input" id="send_msg_text">
                    <!--<input type="text" class="video-discuss-input" id="send_msg_text">
                    <a href="javascript:void(0);" class="video-discuss-face" onclick="showEmotionDialog()"></a>
                    <button class="video-discuss-button" onclick="onSendMsg()">发送</button>-->
                </div>
            </div>
        </div>
    	<div class="goods-box" style="display: none;">
    		<div class="goods-head">
    			<div class="ic-number"></div>
    			<div class="goods-number">全部宝贝&nbsp;&nbsp;<i>105</i></div>
    			<div class="ic_shoppingcart">
    				<i class="goods-count">5</i>
    			</div>
    		</div>
    		<div class="goods-page">
    			<div class="page-20">1-20</div>
    			<div class="page-20">21-40</div>
    			<div class="page-20">31-60</div>
    			<div class="page-20">61-80</div>
    			<div class="page-20">81-100</div>
    			<div class="page-20">101-120</div>
    		</div>
    		<div class="goods-list">  			
    			<div class="goods-item">
    				<div class="g-pic">
    					<img src="img/back-img2.png" />
    				</div>
    				<div class="g-describe">
    					<div class="g-word">2018春夏新款中长款雪纺衫连衣裙荷叶边碎花性感沙滩群</div>
    					<div class="g-price">&yen;&nbsp;<i class="price">59.00</i>&nbsp;<i>起</i></div>
    					<div class="g-btns">
    						<div class="g-try">试穿一下</div>
    						<div class="g-add">加入拿货车</div>
    					</div>
    				</div>
    			</div>
    			<div class="goods-item">
    				<div class="g-pic">
    					<img src="img/back-img2.png" />
    				</div>
    				<div class="g-describe">
    					<div class="g-word">2018春夏新款中长款雪纺衫连衣裙荷叶边碎花性感沙滩群</div>
    					<div class="g-price">&yen;&nbsp;<i class="price">59.00</i>&nbsp;<i>起</i></div>
    					<div class="g-btns">
    						<div class="g-try">试穿一下</div>
    						<div class="g-add">加入拿货车</div>
    					</div>
    				</div>
    			</div>
    			<div class="goods-item">
    				<div class="g-pic">
    					<img src="img/back-img2.png" />
    				</div>
    				<div class="g-describe">
    					<div class="g-word">2018春夏新款中长款雪纺衫连衣裙荷叶边碎花性感沙滩群</div>
    					<div class="g-price">&yen;&nbsp;<i class="price">59.00</i>&nbsp;<i>起</i></div>
    					<div class="g-btns">
    						<div class="g-try">试穿一下</div>
    						<div class="g-add">加入拿货车</div>
    					</div>
    				</div>
    			</div>
    			<div class="goods-item">
    				<div class="g-pic">
    					<img src="img/back-img2.png" />
    				</div>
    				<div class="g-describe">
    					<div class="g-word">2018春夏新款中长款雪纺衫连衣裙荷叶边碎花性感沙滩群</div>
    					<div class="g-price">&yen;&nbsp;<i class="price">59.00</i>&nbsp;<i>起</i></div>
    					<div class="g-btns">
    						<div class="g-try">试穿一下</div>
    						<div class="g-add">加入拿货车</div>
    					</div>
    				</div>
    			</div>
    			<div class="goods-item">
    				<div class="g-pic">
    					<img src="img/back-img2.png" />
    				</div>
    				<div class="g-describe">
    					<div class="g-word">2018春夏新款中长款雪纺衫连衣裙荷叶边碎花性感沙滩群</div>
    					<div class="g-price">&yen;&nbsp;<i class="price">59.00</i>&nbsp;<i>起</i></div>
    					<div class="g-btns">
    						<div class="g-try">试穿一下</div>
    						<div class="g-add">加入拿货车</div>
    					</div>
    				</div>
    			</div>
    		</div>
    	</div>
    </div>
    <!--聊天部分 end-->
</div>

<div id="login_dialog">
    <div id="login_dialog_all">
        <div class="install_div">
            <p for="login_account" class="login_dialog_p">identifier</p>
            <input type="text" class="" id="login_account" value="" placeholder="请输入identifier" maxlength="100">
        </div>
        <div class="install_div">
            <p for="login_pwd" class="login_dialog_p">UserSig</p>
            <input type="password" class="l" id="login_pwd" value="" placeholder="请输入UserSig">
        </div>
    </div>
    <div class="install_button_div">
        <button type="button" class="" onclick="colseLogin()">
            关闭
        </button>
            <button type="button" class="" onclick="independentModeLogin()">
            确定
        </button>
    </div>
</div>

<script type="text/javascript" src="js/jquery-2.1.4.min.js"></script>
<!--引入webim sdk-->
<script type="text/javascript" src="sdk/webim.js?v=1"></script>
<script type="text/javascript" src="sdk/json2.js"></script>
<!--TLS web sdk(只用于托管模式，独立模式不用引入)-->
<script type="text/javascript" src="https://tls.qcloud.com/libs/api.min.js"></script>
<!--webim demo js-->
<script type="text/javascript" src="js/demo_base.js"></script>
<script type="text/javascript" src="js/demo_group_notice.js"></script>
<script src="//imgcache.qq.com/open/qcloud/video/vcplayer/TcPlayer-2.2.2.js"></script>
<script src="js/index.js?time = New Data()"></script>
<script src="lib/js/jquery-weui.js"></script>
<script type="text/javascript">
	/*var x = document.getElementById("myVideo"); 
	$('.pause').on('click',function(){
		x.play(); 
		$(this).addClass('hide')
	})
	
	x.addEventListener('ended',function(){
		alert()
	})*/
	
	var player = new TcPlayer('id_test_video', {
		"m3u8": "http://wssource.hls.inke.cn/live/1528956189910634/playlist.m3u8", //请替换成实际可用的播放地址
		"autoplay" : false,      //iOS下safari浏览器，以及大部分移动端浏览器是不开放视频自动播放这个能力的
		"coverpic" : "https://img2.inke.cn/MTQ5ODgyMjM5MzE4OCMxNDEjanBn.jpg",
		"width" :  '100%',//视频的显示宽度，请尽量使用视频分辨率宽度
		"height" : '100%',//视频的显示高度，请尽量使用视频分辨率高度
		"x5_type":'h5',
		"x5_fullscreen":'true',
		"controls":'none',
		"listener":function(msg){
			if(msg.type == 'load' || msg.type == 'pause'){
				$('.video-pane').append('<div class="pause"></div>')
			}
			if(msg.type == 'playing'){
				$('.pause').remove();
			}
		
		}
	});
	$('video').css('object-fit','cover') ;
	
	
	$('.video-pane').on('click','.pause',function(e){
		player.play() ;
	})
	
	/*$('#send_msg_text').on('blur',function(){
		hideDiscussForm()
		showDiscussTool()
	})*/
	
	//判断设备设置头部距离顶部距离，ios上微信不能全屏
	if((navigator.userAgent).indexOf('Android') > -1 || (navigator.userAgent).indexOf('Adr') > -1){
		$('.video-pane-head').addClass('is-android')
	}
	
	
       //帐号模式，0-表示独立模式，1-表示托管模式
    var accountMode = 0;

    //官方 demo appid,需要开发者自己修改（托管模式）
    var sdkAppID = 1400098433;
    var accountType = 28097;

    var avChatRoomId = 'group_id_284';  //默认房间群ID，群类型必须是直播聊天室（AVChatRoom），这个为官方测试ID(托管模式)

    if (webim.Tool.getQueryString("groupid")) {
        avChatRoomId = webim.Tool.getQueryString("groupid");//用户自定义房间群id
    }

    var selType = webim.SESSION_TYPE.GROUP;
    var selToID = avChatRoomId;//当前选中聊天id（当聊天类型为私聊时，该值为好友帐号，否则为群号）
    var selSess = null;//当前聊天会话

    //默认群组头像(选填)
    var selSessHeadUrl = 'img/2017.jpg';


    //当前用户身份
    var loginInfo = {
        'sdkAppID': sdkAppID, //用户所属应用id,必填
        'appIDAt3rd': sdkAppID, //用户所属应用id，必填
        'accountType': accountType, //用户所属应用帐号类型，必填
        'identifier': "test1", //当前用户ID,必须是否字符串类型，选填
        'identifierNick': "null", //当前用户昵称，选填
        'userSig': "eJxFkF1PgzAYhf8LtxrtB1Uw2YXB6UiYjs9Nb5pCO1KRlpSK24z-XSQs3j5P3pxz3m8ni9Ir1nWSU2YpNty5c4BzOWFx6KQRlO2tMCOGhBAEwNkOwvRSq1EgAAlEGIB-KblQVu7ldGhFb*EselmPZL3MgzAO2vKRHdKqWPOVfs5weG1ChrrkNKRhrgKsS*gWFyreJB9fYf0WD-fLRNU5x9td0w7*i58eUV1mcdHgSD9tUrDaRe8PxHtdnMN4Q6dtf*3dsZ3vuRjP0spWTKvQrYcgJjczZ1WlP5Wl9tiJ6Rk-v581V34_", //当前用户身份凭证，必须是字符串类型，选填
        'headurl': 'img/2016.gif'//当前用户默认头像，选填
    };
    //监听（多终端同步）群系统消息方法，方法都定义在demo_group_notice.js文件中
    //注意每个数字代表的含义，比如，
    //1表示监听申请加群消息，2表示监听申请加群被同意消息，3表示监听申请加群被拒绝消息等
    var onGroupSystemNotifys = {
        //"1": onApplyJoinGroupRequestNotify, //申请加群请求（只有管理员会收到,暂不支持）
        //"2": onApplyJoinGroupAcceptNotify, //申请加群被同意（只有申请人能够收到,暂不支持）
        //"3": onApplyJoinGroupRefuseNotify, //申请加群被拒绝（只有申请人能够收到,暂不支持）
        //"4": onKickedGroupNotify, //被管理员踢出群(只有被踢者接收到,暂不支持)
        "5": onDestoryGroupNotify, //群被解散(全员接收)
        //"6": onCreateGroupNotify, //创建群(创建者接收,暂不支持)
        //"7": onInvitedJoinGroupNotify, //邀请加群(被邀请者接收,暂不支持)
        //"8": onQuitGroupNotify, //主动退群(主动退出者接收,暂不支持)
        //"9": onSetedGroupAdminNotify, //设置管理员(被设置者接收,暂不支持)
        //"10": onCanceledGroupAdminNotify, //取消管理员(被取消者接收,暂不支持)
        "11": onRevokeGroupNotify, //群已被回收(全员接收)
        "255": onCustomGroupNotify//用户自定义通知(默认全员接收)
    };


    //监听连接状态回调变化事件
    var onConnNotify = function (resp) {
        switch (resp.ErrorCode) {
            case webim.CONNECTION_STATUS.ON:
                //webim.Log.warn('连接状态正常...');
                break;
            case webim.CONNECTION_STATUS.OFF:
                webim.Log.warn('连接已断开，无法收到新消息，请检查下你的网络是否正常');
                break;
            default:
                webim.Log.error('未知连接状态,status=' + resp.ErrorCode);
                break;
        }
    };


    //监听事件
    var listeners = {
        "onConnNotify": onConnNotify, //选填
        "jsonpCallback": jsonpCallback, //IE9(含)以下浏览器用到的jsonp回调函数,移动端可不填，pc端必填
        "onBigGroupMsgNotify": onBigGroupMsgNotify, //监听新消息(大群)事件，必填
        "onMsgNotify": onMsgNotify,//监听新消息(私聊(包括普通消息和全员推送消息)，普通群(非直播聊天室)消息)事件，必填
        "onGroupSystemNotifys": onGroupSystemNotifys, //监听（多终端同步）群系统消息事件，必填
        "onGroupInfoChangeNotify": onGroupInfoChangeNotify//监听群资料变化事件，选填
    };

    var isAccessFormalEnv = true;//是否访问正式环境

    if (webim.Tool.getQueryString("isAccessFormalEnv") == "false") {
        isAccessFormalEnv = false;//访问测试环境
    }

    var isLogOn = false;//是否在浏览器控制台打印sdk日志

    //其他对象，选填
    var options = {
        'isAccessFormalEnv': isAccessFormalEnv,//是否访问正式环境，默认访问正式，选填
        'isLogOn': isLogOn//是否开启控制台打印日志,默认开启，选填
    };

    var curPlayAudio = null;//当前正在播放的audio对象

    var openEmotionFlag = false;//是否打开过表情

    sdkLogin();
    if(/debug/gi.test(location.hash)){
    }

    function colseLogin(){
        $('#login_dialog').hide();
    }
</script>
</body>
</html>
